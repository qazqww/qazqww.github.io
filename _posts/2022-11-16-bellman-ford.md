---
layout: post
title:  "벨만-포드 알고리즘"
categories: algorithm
tags: [graph]
---

#### *
그래프의 최단 경로 탐색 알고리즘 문제를 풀면서 다익스트라와 플로이드-워셜 알고리즘은 많이 다뤄보았지만, 벨만-포드 알고리즘은 다소 생소해서 따로 정리해보고자 한다.
<br>

#### 용도
음의 가중치가 존재하는 그래프의 최단 거리 탐색에 사용
<br>

#### 시간 복잡도
- **O(V * E)**

다익스트라에 비해선 느리므로, 음의 가중치가 없는 그래프에서는 다익스트라 알고리즘을 사용하는 것이 낫다.
<br>

#### 개념
1. 시작점에서 각 노드까지의 거리를 담는 dist Array를 생성하고, INF로 초기화한다.  
2. 정점의 개수만큼, 모든 간선의 탐색을 반복한다. (※ 시간복잡도 V * E 는 이 부분에 의해 발생)  
    2-1. 시작점부터 탐색을 시작한다.  
    2-2. 매 탐색마다 dist[end] > dist[start] + weight인 경우, dist[end]를 갱신한다.

음의 길이를 가진 간선이 존재하므로, 매번 모든 간선이 최단 경로를 결정하는 데에 영향을 줄 수 있어서 모든 간선을 탐색해야 하는 것 같다. 또한 최대로 가질 수 있는 경로의 길이가 V 이므로, 모든 경로를 찾기 위해 V번 반복 수행하는 것 같다.
<br>

#### 추가 고려 사항
그래프에 음수 사이클이 존재하는 경우에는, 간선 탐색을 반복할 때마다 사이클이 진행되어 최단 경로가 갱신되므로 알고리즘이 제 기능을 하지 못하게 된다.
이 경우는 모든 간선을 탐색하는 과정을 한 번 더 거침으로 분간이 가능하다.  
음의 사이클을 고려하지 않을 경우 최단 거리 갱신에 영향을 줄 수 있는건 경로의 최대 길이인 V번까지인데, V + 1번째에도 갱신이 발생한다면 정상적이지 않은 로직(음의 사이클)이 돌고있다는 뜻이 된다.

또한 음수 사이클이 계속 반복될 경우, 매 탐색마다 최단 경로가 음수로 계속 누적되어 예기지 못한 underflow 문제가 발생할 가능성도 고려할 필요가 있다.

다른 이슈로는, 도달할 수 없는 부분에 음수 사이클이 있는 경우가 있다. 이 경우엔 값을 갱신할 때 갱신하고자 하는 정점의 계산에 INF가 들어가있는지 체크해줌으로써 해결할 수 있다.

#### 관련 알고리즘 문제

백준 [11657 타임머신](https://www.acmicpc.net/problem/11657)


<details>
<summary>그리고 위 문제를 푸는 데에 참고한 글</summary>
<div markdown="1">

- 음수 사이클이 존재하는 경우 underflow  
[https://www.acmicpc.net/board/view/50448](https://www.acmicpc.net/board/view/50448)

- 닿지 않는 부분에 있는 음수 사이클  
[https://www.acmicpc.net/board/view/52434](https://www.acmicpc.net/board/view/52434)
</div>
</details>